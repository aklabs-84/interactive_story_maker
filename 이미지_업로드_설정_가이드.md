# 이미지 업로드 기능 설정 가이드

## 📋 개요
이 가이드는 인터랙티브 스토리 메이커에 이미지 업로드 기능을 설정하는 방법을 안내합니다.

## 🔧 설정 단계

### 1단계: 구글 드라이브 폴더 생성

1. [Google Drive](https://drive.google.com)에 접속
2. 새 폴더 생성 (예: "InteractiveStory_Images")
3. 폴더 우클릭 → **공유** → **링크가 있는 모든 사용자**로 설정
4. 폴더 URL에서 폴더 ID 복사
   - URL 형식: `https://drive.google.com/drive/folders/FOLDER_ID`
   - `FOLDER_ID` 부분만 복사

### 2단계: Google Apps Script 설정

1. [Google Sheets](https://sheets.google.com)에서 기존 스프레드시트 열기
2. **확장 프로그램** → **Apps Script** 클릭
3. `google-apps-script-updated.js` 파일 내용을 복사하여 붙여넣기
4. 코드 상단의 설정값 수정:

```javascript
const SPREADSHEET_ID = '1PezTZ3hDuepfQjy9vwjdZWl0VSWv02c6MIYVQua-0sw';
const IMAGE_FOLDER_ID = 'YOUR_DRIVE_FOLDER_ID'; // 1단계에서 복사한 폴더 ID
```

5. **저장** 클릭 (💾 아이콘)
6. **배포** → **새 배포** 클릭
7. 배포 유형: **웹 앱**
   - 설명: "Interactive Story Maker v2"
   - 실행 계정: **나**
   - 액세스 권한: **모든 사용자**
8. **배포** 클릭
9. **웹 앱 URL** 복사 (예: `https://script.google.com/macros/s/...`)

### 3단계: config.js 업데이트

`js/config.js` 파일을 열고 웹 앱 URL을 업데이트:

```javascript
const CONFIG = {
  SPREADSHEET_WEB_APP_URL: '여기에_웹앱_URL_붙여넣기',
  WEB_APP_BASE_URL: window.location.origin + window.location.pathname.replace(/\/[^\/]*$/, '')
};
```

### 4단계: 권한 승인

1. Apps Script 에디터에서 **실행** → **testFunction** 선택
2. **실행** 버튼 클릭
3. 권한 검토 창이 나타나면:
   - **권한 검토** 클릭
   - 구글 계정 선택
   - **고급** → **프로젝트명으로 이동(안전하지 않음)** 클릭
   - **허용** 클릭

## ✅ 테스트

1. 로컬 서버 실행:
```bash
python3 -m http.server 8000
```

2. 브라우저에서 `http://localhost:8000/editor.html` 접속

3. 이미지 업로드 테스트:
   - 시작 이미지 또는 선택지 이미지 파일 선택
   - **업로드** 버튼 클릭
   - 미리보기가 표시되는지 확인

## 📊 기능 설명

### 이미지 크기 제한
- **최대 크기**: 2MB
- **자동 압축**: 800x800px 이내로 자동 리사이즈
- **품질**: JPEG 80% 품질로 압축

### 저장 방식
- 이미지는 구글 드라이브에 저장
- 이미지 URL은 스토리 데이터(JSON)에 포함되어 스프레드시트에 저장
- 플레이어에서 자동으로 이미지 로드 및 표시

### 지원 형식
- PNG, JPEG, GIF, WebP 등 모든 이미지 형식

## 🔍 문제 해결

### 이미지가 업로드되지 않을 때
1. 웹 앱 URL이 올바르게 설정되었는지 확인
2. 드라이브 폴더 ID가 올바른지 확인
3. 브라우저 콘솔(F12)에서 오류 메시지 확인

### 권한 오류가 발생할 때
1. Apps Script에서 testFunction을 다시 실행하여 권한 재승인
2. 드라이브 폴더 공유 설정이 "링크가 있는 모든 사용자"인지 확인

### 이미지가 표시되지 않을 때
1. 드라이브 폴더의 공유 설정 확인
2. 업로드된 파일의 공유 설정 확인 (자동으로 설정되어야 함)
3. 브라우저에서 이미지 URL에 직접 접속하여 확인

## 📝 참고사항

- 구글 드라이브 무료 계정: 15GB 용량 제공
- 이미지는 자동으로 압축되므로 실제 저장 용량은 원본보다 작음
- 업로드된 이미지는 구글 드라이브에서 수동으로 관리 가능

## 🎉 완료!

이제 이미지 업로드 기능을 사용할 준비가 되었습니다!
